<div class="container container-padding">
    <div class="row">
        <div class="col-md-3">
            <div class="text-center select"><p>CATEGORY</p></div>
            <div class="text-center select-category">
                <%= link_to "全カテゴリー", reviews_path, class: "select-button" %>
            </div>
            <% @review_categories.each do |category| %>
                <div class="text-center select-category">
                    <%= link_to category.name, category_reviews_path(name: "#{category.name}"),method: :post, class: "select-button" %>
                </div>
            <% end %>
            <div class="text-center select"><p>Search</p></div>
            <div>
                <%= form_tag(search_reviews_path, method: :get ) do %>
                    <div class="text-center search-box">
                        <%= select_tag(:option, options_for_select([["ユーザー名", "1"],["商品名", "2"]])) %>
                        <%= text_field_tag :search %>
                    </div>
                    <div class="text-right">
                        <%= submit_tag "検索", class: "btn btn-warning" %>
                    </div>
                <% end %>
            </div>
        </div>

        <div class="col-md-9">
            <div class="content-box">
                <% if @user_or_product == "1" %>
                    <p class="search-text">ユーザー名に '<%= @search %>' を含むレビュー一覧</p>
                    <% if @user_reviews.blank? %>
                        検索結果が見つかりません
                    <% else %>
                        <div class="review-index">
                            <% @user_reviews.each do |review| %>
                                <div class="review-index-item">
                                    <%= link_to review_path(review) do %>
                                        <div class="col-sm-12 col-xs-5">
                                        <%= attachment_image_tag review, :image, size: "200x150", fallback: 'no_image.png',size: "200x150", class: "review-index-image" %>
                                        </div>
                                        <div class="col-sm-12 col-xs-7">
                                            <div class="text-center review-name">
                                                <%= review.name %><br>
                                                <%= review.updated_at.strftime("%Y-%m-%d") %>
                                                <div class="text-center" id="star-rate-<%= review.id %>" data-score="<%= review.rate %>"></div>
                                                <i class="fa fa-heart" aria-hidden="true" style="color: red;"></i>
                                                <%= review.favorites.count %>
                                            </div>
                                            <div class="review-content">
                                                <p><%= review.content %></p>
                                            </div>
                                        </div>
                                    <% end %>
                                </div>
                                <%# 星評価 %> 
                                <script>
                                    $('#star-rate-<%= review.id %>').raty({
                                    readOnly: true,
                                    size: 36,
                                    starOff:  '<%= asset_path('star-off.png') %>',
                                    starOn : '<%= asset_path('star-on.png') %>',
                                    starHalf: '<%= asset_path('star-half.png') %>',
                                    score: function() {
                                        return $(this).attr('data-score');
                                    },
                                });
                                </script>
                            <% end %>
                            <div class="text-center">
                                <%= paginate @user_reviews %>
                            </div>
                        </div>
                    <% end %>
                <% elsif @user_or_product == "2" %>
                    <p>商品名に '<%= @search %>' を含むレビュー一覧</p>
                    <% if @reviews.blank? %>
                        検索結果が見つかりません
                    <% else %>
                        <div class="review-index">
                            <% @reviews.each do |review| %>
                                <div class="review-index-item">
                                    <%= link_to review_path(review) do %>
                                        <div class="col-sm-12 col-xs-5">
                                        <%= attachment_image_tag review, :image, size: "200x150", fallback: 'no_image.png',size: "200x150", class: "review-index-image" %>
                                        </div>
                                        <div class="col-sm-12 col-xs-7">
                                            <div class="text-center review-name">
                                                <%= review.name %><br>
                                                <%= review.updated_at.strftime("%Y-%m-%d") %>
                                                <div class="text-center" id="star-rate-<%= review.id %>" data-score="<%= review.rate %>"></div>
                                                <i class="fa fa-heart" aria-hidden="true" style="color: red;"></i>
                                                <%= review.favorites.count %>
                                            </div>
                                            <div class="review-content">
                                                <p><%= review.content %></p>
                                            </div>
                                        </div>
                                    <% end %>
                                </div>
                                <%# 星評価 %> 
                                <script>
                                    $('#star-rate-<%= review.id %>').raty({
                                    readOnly: true,
                                    size: 36,
                                    starOff:  '<%= asset_path('star-off.png') %>',
                                    starOn : '<%= asset_path('star-on.png') %>',
                                    starHalf: '<%= asset_path('star-half.png') %>',
                                    score: function() {
                                        return $(this).attr('data-score');
                                    },
                                });
                                </script>
                            <% end %>
                            <div class="text-center">
                                <%= paginate @reviews %>
                            </div>
                        </div>
                    <% end %>
                <% else %>
                    <p><%= @same_review_name %> のレビュー一覧</p>
                    <div class="review-index">
                        <% @same_reviews.each do |review| %>
                            <div class="review-index-item">
                                <%= link_to review_path(review) do %>
                                    <div class="col-sm-12 col-xs-5">
                                    <%= attachment_image_tag review, :image, size: "200x150", fallback: 'no_image.png',size: "200x150", class: "review-index-image" %>
                                    </div>
                                    <div class="col-sm-12 col-xs-7">
                                        <div class="text-center review-name">
                                            <%= review.name %><br>
                                            <%= review.updated_at.strftime("%Y-%m-%d") %>
                                            <div class="text-center" id="star-rate-<%= review.id %>" data-score="<%= review.rate %>"></div>
                                            <i class="fa fa-heart" aria-hidden="true" style="color: red;"></i>
                                            <%= review.favorites.count %>
                                        </div>
                                        <div class="review-content">
                                            <p><%= review.content %></p>
                                        </div>
                                    </div>
                                <% end %>
                            </div>
                            <%# 星評価 %> 
                            <script>
                                $('#star-rate-<%= review.id %>').raty({
                                readOnly: true,
                                size: 36,
                                starOff:  '<%= asset_path('star-off.png') %>',
                                starOn : '<%= asset_path('star-on.png') %>',
                                starHalf: '<%= asset_path('star-half.png') %>',
                                score: function() {
                                    return $(this).attr('data-score');
                                },
                            });
                            </script>
                        <% end %>
                        <div class="text-center">
                            <%= paginate @same_reviews %>
                        </div>
                    </div>
                <% end %>
            </div>
        </div>
    </div>
</div>